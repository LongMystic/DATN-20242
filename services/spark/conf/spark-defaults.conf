# Spark Default Configuration
# spark.master                     spark://spark-master:7077
# spark.dynamicAllocation.enabled  true
spark.shuffle.service.enabled    true

spark.driver.extraClassPath      /opt/bitnami/spark/jars/iceberg-spark-runtime-3.3_2.12-1.3.0.jar:/opt/bitnami/spark/jars/mysql-connector-java-8.0.21.jar
spark.executor.extraClassPath    /opt/bitnami/spark/jars/iceberg-spark-runtime-3.3_2.12-1.3.0.jar:/opt/bitnami/spark/jars/mysql-connector-java-8.0.21.jar

# Hive Metastore Integration
spark.sql.catalogImplementation=hive
spark.sql.warehouse.dir=/user/hive/warehouse
spark.hive.metastore.uris=thrift://hive-metastore:9083

# Thrift Server Configuration
spark.sql.hive.thriftServer.singleSession=false
spark.sql.hive.thriftServer.hiveServer2.authentication=NONE

# Performance Configuration
spark.executor.memory=1g
spark.driver.memory=1g
spark.executor.cores=1
spark.driver.cores=1
spark.sql.shuffle.partitions=10

# iceberg Configuration
spark.sql.extensions                        org.apache.iceberg.spark.extensions.IcebergSparkSessionExtensions
spark.sql.catalog.iceberg                   org.apache.iceberg.spark.SparkCatalog
spark.sql.catalog.iceberg.type              hive
spark.sql.catalog.iceberg.uri               thrift://hive-metastore:9083

spark.sql.catalog.spark_catalog             org.apache.iceberg.spark.SparkSessionCatalog
spark.sql.catalog.spark_catalog.type        hive

# for monitoring with prometheus
spark.ui.prometheus.enabled                 true
spark.executor.processTreeMetrics.enabled   true

# this for spark history server
spark.eventLog.enabled=true
spark.eventLog.dir=hdfs://namenode:8020/spark-logs
spark.history.fs.logDirectory=hdfs://namenode:8020/spark-events
spark.history.fs.cleaner.enabled=true
spark.history.fs.cleaner.interval=1d
spark.history.fs.cleaner.maxAge=7d
